"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[103],{1530:function(t,e,a){function n(t){return{all:t=t||new Map,on:function(e,a){var n=t.get(e);n?n.push(a):t.set(e,[a])},off:function(e,a){var n=t.get(e);n&&(a?n.splice(n.indexOf(a)>>>0,1):t.set(e,[]))},emit:function(e,a){var n=t.get(e);n&&n.slice().map((function(t){t(a)})),(n=t.get("*"))&&n.slice().map((function(t){t(e,a)}))}}}a.d(e,{Z:function(){return l}});const s=n();var l=s},103:function(t,e,a){a.r(e),a.d(e,{default:function(){return Dt}});var n=a(6252);const s={class:"d-lg-none position-sticky bottom-0 bg-light"},l={class:"container d-flex justify-content-between"};function o(t,e,a,o,i,r){const c=(0,n.up)("FrontNavbar"),d=(0,n.up)("router-view"),u=(0,n.up)("FrontCart"),p=(0,n.up)("FrontMember");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(c),(0,n.Wm)(d),(0,n._)("div",s,[(0,n._)("div",l,[(0,n.Wm)(u),(0,n.Wm)(p)])])],64)}const i={class:"navbar navbar-expand-lg navbar-light bg-light sticky-top"},r={class:"container position-relative justify-content-center align-items-center"},c=(0,n.Uk)("Pet Pet"),d=(0,n._)("button",{class:"navbar-toggler position-absolute top-0 end-0 me-2",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,n._)("span",{class:"navbar-toggler-icon"})],-1),u={class:"collapse navbar-collapse",id:"navbarNav"},p={class:"navbar-nav"},h={class:"nav-item"},g=(0,n.Uk)("About"),v={class:"nav-item"},m=(0,n.Uk)("Products"),b={class:"nav-item me-auto"},k=(0,n.Uk)("Cart"),_={class:"d-none d-lg-flex"};function f(t,e,a,s,l,o){const f=(0,n.up)("router-link"),w=(0,n.up)("FrontMember"),y=(0,n.up)("FrontCart");return(0,n.wg)(),(0,n.iD)("nav",i,[(0,n._)("div",r,[(0,n.Wm)(f,{to:"/",class:"navbar-brand"},{default:(0,n.w5)((()=>[c])),_:1}),d,(0,n._)("div",u,[(0,n._)("ul",p,[(0,n._)("li",h,[(0,n.Wm)(f,{to:"/about",class:"nav-link"},{default:(0,n.w5)((()=>[g])),_:1})]),(0,n._)("li",v,[(0,n.Wm)(f,{to:"/products",class:"nav-link"},{default:(0,n.w5)((()=>[m])),_:1})]),(0,n._)("li",b,[(0,n.Wm)(f,{to:"/cart",class:"nav-link"},{default:(0,n.w5)((()=>[k])),_:1})])])]),(0,n._)("div",_,[(0,n.Wm)(w),(0,n.Wm)(y)])])])}var w=a(9963);const y={class:"d-flex align-items-center"},C={key:0,class:"d-flex"},x={key:0,class:"nav-item"},D=(0,n.Uk)("後台"),I={class:"nav-item"},W={key:1,class:"nav-item border-danger"},U=(0,n.Uk)("登入");function F(t,e,a,s,l,o){const i=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",y,[l.loggedIn?((0,n.wg)(),(0,n.iD)("div",C,[l.checkSuccess?((0,n.wg)(),(0,n.iD)("div",x,[(0,n.Wm)(i,{to:"/admin",class:"nav-link link-secondary"},{default:(0,n.w5)((()=>[D])),_:1})])):(0,n.kq)("",!0),(0,n._)("div",I,[(0,n._)("a",{href:"#",class:"nav-link link-secondary",onClick:e[0]||(e[0]=(0,w.iM)(((...t)=>o.logOut&&o.logOut(...t)),["prevent"]))},"登出")])])):((0,n.wg)(),(0,n.iD)("div",W,[(0,n.Wm)(i,{to:"/Login",class:"nav-link link-secondary"},{default:(0,n.w5)((()=>[U])),_:1})]))])}var $={data(){return{loggedIn:!1,checkSuccess:!1}},methods:{checkAdmin(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");t&&(this.$http.defaults.headers.common.Authorization=t,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/user/check").then((()=>{this.loggedIn=!0})).catch((t=>{console.dir(t)}))),this.$http.get("https://vue3-course-api.hexschool.io/v2/api/yclu/admin/products").then((()=>{this.checkSuccess=!0})).catch((t=>{console.dir(t)}))},logOut(){document.cookie="hexToken=;expires=;",alert("已登出"),this.loggedIn=!1,this.checkSuccess=!1}},mounted(){this.checkAdmin()}},z=a(3744);const q=(0,z.Z)($,[["render",F]]);var L=q,M=a(3577);const N=(0,n._)("span",{class:"text-light"},"Cart",-1),Z=(0,n._)("i",{class:"bi bi-cart-fill position-absolute top-50 start-50 translate-middle",style:{"font-size":"2rem"}},null,-1),E={class:"position-absolute top-50 start-50 translate-middle text-white"},A={class:"d-none d-lg-block nav-link position-relative link-secondary","data-bs-toggle":"collapse","data-bs-target":"#collapseExample",style:{cursor:"pointer"}},O=(0,n._)("span",{class:"text-light"},"Cart",-1),S=(0,n._)("i",{class:"bi bi-cart-fill position-absolute top-50 start-50 translate-middle",style:{"font-size":"2rem"}},null,-1),j={class:"position-absolute top-50 start-50 translate-middle text-white"},H={class:"collapse position-absolute top-100 end-0 bg-white shadow-sm p-3",id:"collapseExample"},P=(0,n._)("div",{class:"d-flex justify-content-between"},[(0,n._)("h5",null,"購物車"),(0,n._)("button",{type:"button",class:"btn btn-close","data-bs-toggle":"collapse","data-bs-target":"#collapseExample",role:"button","aria-expanded":"false","aria-controls":"collapseExample"})],-1),T={key:0,class:"my-5 text-center"},Y=(0,n.Uk)(" 購物車裡沒有東西！快去逛逛吧！！ "),V={key:1},K={class:"overflow-auto",style:{"max-height":"50vh"}},B={class:"table"},G=(0,n._)("div",{class:"w-100 h-100"},null,-1),J=["src","alt"],Q={class:"fw-bold"},R=(0,n.Uk)(" 價格： "),X={key:0},tt={key:1},et={class:"text-secondary me-2"},at=(0,n.Uk)(" 數量： "),nt=(0,n._)("br",null,null,-1),st={class:"input-group input-group-sm mb-3"},lt=["onClick"],ot=["onUpdate:modelValue","onChange"],it=["onClick"],rt=["onClick","disabled"],ct={class:"text-end mb-3"},dt=(0,n.Uk)(" 總金額："),ut={class:"text-danger fw-bold"},pt=(0,n.Uk)("元 "),ht={class:"text-end"},gt=(0,n._)("button",{class:"btn btn-danger","data-bs-toggle":"collapse","data-bs-target":"#collapseExample"},[(0,n.Uk)("去結帳 "),(0,n._)("i",{class:"bi bi-arrow-right"})],-1);function vt(t,e,a,s,l,o){const i=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(i,{to:"/Cart",class:"d-lg-none nav-link position-relative link-secondary",style:{cursor:"pointer"}},{default:(0,n.w5)((()=>[N,Z,(0,n._)("small",E,(0,M.zw)(l.cartData.carts.length),1)])),_:1}),(0,n._)("a",A,[O,S,(0,n._)("small",j,(0,M.zw)(l.cartData.carts.length),1)]),(0,n._)("div",H,[P,0==l.cartData.carts.length?((0,n.wg)(),(0,n.iD)("div",T,[(0,n.Wm)(i,{to:"/products"},{default:(0,n.w5)((()=>[Y])),_:1})])):((0,n.wg)(),(0,n.iD)("div",V,[(0,n._)("div",K,[(0,n._)("table",B,[(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.cartData.carts,(e=>((0,n.wg)(),(0,n.iD)("tr",{key:e.id,height:"100"},[(0,n._)("td",null,[(0,n.Wm)(i,{to:`/product/${e.product.id}`},{default:(0,n.w5)((()=>[G,(0,n._)("img",{src:e.product.imageUrl,alt:e.product.title,height:"100"},null,8,J)])),_:2},1032,["to"])]),(0,n._)("td",null,[(0,n._)("div",null,[(0,n._)("h6",Q,(0,M.zw)(e.product.title),1),(0,n._)("div",null,[R,e.product.price===e.product.origin_price?((0,n.wg)(),(0,n.iD)("span",X,(0,M.zw)(e.price)+" 元 ",1)):((0,n.wg)(),(0,n.iD)("span",tt,[(0,n._)("small",et,[(0,n._)("del",null,(0,M.zw)(e.product.origin_price)+" 元",1)]),(0,n._)("span",null,(0,M.zw)(e.product.price)+" 元",1)]))]),(0,n._)("div",null,[at,nt,(0,n._)("div",st,[(0,n._)("button",{class:"btn btn-secondary",type:"button",onClick:t=>o.updateCartItem(e,-1)},"-",8,lt),(0,n.wy)((0,n._)("input",{type:"number",onkeypress:"return (event.charCode == 8 || event.charCode == 0 || event.charCode == 13) ? null : event.charCode >= 48 && event.charCode <= 57",class:"form-control","onUpdate:modelValue":t=>e.qty=t,onChange:t=>o.updateCartItem(e,0)},null,40,ot),[[w.nr,e.qty,void 0,{number:!0}]]),(0,n._)("button",{class:"btn btn-secondary",type:"button",onClick:t=>o.updateCartItem(e,1)},"+",8,it)])])])]),(0,n._)("td",null,[(0,n._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>o.removeCartItem(e.id),disabled:t.isLoadingItem===e.id}," 刪除 ",8,rt)])])))),128))])])]),(0,n._)("div",ct,[dt,(0,n._)("span",ut,(0,M.zw)(l.cartData.total),1),pt]),(0,n._)("div",ht,[(0,n.Wm)(i,{to:"/cart",class:"link-secondary px-2"},{default:(0,n.w5)((()=>[gt])),_:1})])]))])],64)}var mt=a(1530),bt={name:"FrontCart",data(){return{cartData:{carts:[]}}},methods:{getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/yclu/cart").then((t=>{this.cartData=t.data.data})).catch((t=>{console.dir(t)}))},removeCartItem(t){this.isLoadingItem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/yclu/cart/${t}`).then((t=>{alert(t.data.message),this.getCart(),this.isLoadingItem=""})).catch((t=>{console.dir(t)}))},updateCartItem(t,e){if(t.qty+e===0)return void this.removeCartItem(t.id);if(t.qty+e<1||t.qty%1!==0)return void alert("輸入數量錯誤");const a={product_id:t.id,qty:t.qty+e};this.isLoadingItem=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/yclu/cart/${t.id}`,{data:a}).then((t=>{this.getCart(),this.isLoadingItem=""})).catch((t=>{console.dir(t)}))}},mounted(){this.getCart(),mt.Z.on("get-cart",(()=>{this.getCart()}))}};const kt=(0,z.Z)(bt,[["render",vt]]);var _t=kt,ft={name:"FrontNavbar",components:{FrontMember:L,FrontCart:_t}};const wt=(0,z.Z)(ft,[["render",f]]);var yt=wt,Ct={components:{FrontNavbar:yt,FrontMember:L,FrontCart:_t}};const xt=(0,z.Z)(Ct,[["render",o]]);var Dt=xt}}]);
//# sourceMappingURL=103.e12aaa44.js.map